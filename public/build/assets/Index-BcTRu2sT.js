import{j as e,M as zt,r as Pt,a as Tt}from"./markdown-CGR2RDhP.js";import{a as c,L as H,b as F,H as Dt}from"./vendor-4eYsLQor.js";import{I as u}from"./Icon-D8dZPIEy.js";import{a as he,u as at}from"./app-DSWuFYjX.js";import{F as Mt}from"./Footer-BEUEIhX1.js";import{A as re}from"./index-DHi4oDk3.js";import{m as p}from"./proxy-CfrAqMoI.js";import{r as It}from"./index-Cn3or5DS.js";import"./app-tHzcnWQi.js";const $t=({className:d=""})=>{const{isDarkMode:o}=he(),[a,y]=c.useState(null),[b,s]=c.useState(!0),[f,T]=c.useState(!1),[S,w]=c.useState(!1);c.useEffect(()=>{const k=localStorage.getItem("donation_dismissed_until"),N=Date.now();if(k&&N<parseInt(k)){w(!0),s(!1);return}v()},[]);const v=async()=>{try{const N=await(await fetch("/api/donation-settings")).json();N&&N.enabled&&(y(N),setTimeout(()=>{T(!0)},2e3))}catch(k){console.error("Error fetching donation settings:",k)}finally{s(!1)}},C=()=>{w(!0),T(!1)},j=()=>{const k=Date.now()+6048e5;localStorage.setItem("donation_dismissed_until",k.toString()),w(!0),T(!1)};return b||!a||S?null:e.jsx(re,{children:f&&e.jsx(p.div,{className:"fixed inset-0 backdrop-blur-lg flex items-center justify-center z-50 p-4 modal-overlay",style:{background:o?"linear-gradient(135deg, rgba(31, 41, 55, 0.85) 0%, rgba(17, 24, 39, 0.9) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.85) 0%, rgba(255, 255, 255, 0.9) 100%) !important"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:()=>T(!1),children:e.jsxs(p.div,{className:`max-w-md w-full rounded-3xl shadow-2xl relative overflow-hidden border-2 backdrop-blur-md modal-content donation-modal ${o?"dark":""} ${o?"border-gray-600/50":"border-gray-200/50"}`,style:{background:a.background_color||(o?"linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(17, 24, 39, 0.98) 100%) !important":"linear-gradient(135deg, rgba(249, 250, 251, 0.95) 0%, rgba(255, 255, 255, 0.98) 100%) !important"),color:a.text_color||(o?"#ffffff !important":"#333333 !important"),backdropFilter:"blur(20px)",boxShadow:o?"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.05)":"0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.1)"},initial:{scale:.8,opacity:0,y:50,rotateX:15},animate:{scale:1,opacity:1,y:0,rotateX:0},exit:{scale:.8,opacity:0,y:50,rotateX:15},transition:{type:"spring",damping:25,stiffness:300,duration:.5},whileHover:{scale:1.02,y:-5},onClick:k=>k.stopPropagation(),children:[e.jsx(p.button,{onClick:C,className:`absolute top-5 right-5 w-10 h-10 flex items-center justify-center rounded-full transition-all duration-300 z-10 text-xl font-medium ${o?"bg-gray-700/70 hover:bg-gray-600/80 text-gray-300 hover:text-white border border-gray-600/50":"bg-gray-100/70 hover:bg-gray-200/80 text-gray-600 hover:text-gray-800 border border-gray-200/50"}`,whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},children:"√ó"}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(p.h3,{className:"text-2xl font-bold mb-6 pr-10 leading-tight",style:{color:a.text_color||(o?"#ffffff":"#333333")},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:a.title}),e.jsx(p.div,{className:`text-base leading-relaxed prose max-w-none ${o?"dark:prose-invert":""}`,style:{color:a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-body":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-headings":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-bold":a.text_color||(o?"#ffffff":"#333333"),"--tw-prose-links":a.text_color||(o?"#ffffff":"#333333")},dangerouslySetInnerHTML:{__html:a.content},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2}})]}),e.jsxs(p.div,{className:"space-y-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(p.div,{className:"flex-1",children:e.jsx(H,{href:"/donation",className:"w-full block px-6 py-4 rounded-xl font-bold text-white text-center transition-all duration-300 shadow-lg",style:{backgroundColor:a.button_color||"#3b82f6"},onMouseEnter:k=>{k.target.style.filter="brightness(110%)",k.target.style.transform="translateY(-2px)",k.target.style.boxShadow="0 20px 40px rgba(0,0,0,0.2)"},onMouseLeave:k=>{k.target.style.filter="brightness(100%)",k.target.style.transform="translateY(0px)",k.target.style.boxShadow="0 10px 25px rgba(0,0,0,0.1)"},children:"üíù D…ôst…ôk Ol"})}),e.jsx(p.button,{className:`px-6 py-4 rounded-xl font-medium transition-all duration-300 hover:shadow-md backdrop-blur-sm ${o?"text-gray-300 border border-gray-600/60 hover:bg-gray-700/60 hover:border-gray-500":"text-gray-600 border border-gray-300/60 hover:bg-gray-50/60 hover:border-gray-400"}`,onClick:C,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Baƒüla"})]}),e.jsx(p.button,{className:`w-full text-sm underline transition-colors py-2 rounded-lg ${o?"text-gray-400 hover:text-gray-200 hover:bg-gray-700/30":"text-gray-500 hover:text-gray-700 hover:bg-gray-100/30"}`,onClick:j,whileHover:{scale:1.02},children:"1 h…ôft…ô g√∂st…ôrm…ô"})]})]})]})})})},Lt=({isOpen:d,onAccept:o,onReject:a,siteName:y="XIV AI"})=>{const{theme:b}=he(),[s,f]=c.useState(!1),[T,S]=c.useState(null),[w,v]=c.useState(!0),C=async()=>{try{const k=await(await fetch("/api/guest-terms")).json();S(k)}catch{console.warn("Failed to fetch admin terms, using fallback"),S({title:"ƒ∞stifad…ô ≈û…ôrtl…ôri",content:"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"})}finally{v(!1)}};return c.useEffect(()=>{d&&!T&&C()},[d]),c.useEffect(()=>(d?(f(!0),document.body.style.overflow="hidden"):document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[d]),d?e.jsx(re,{children:s&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:()=>a&&a()}),e.jsxs(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full mx-4 max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:b?.primary_color?`linear-gradient(135deg, ${b.primary_color} 0%, ${b.secondary_color||b.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(u,{name:"shield_check",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:w?"ƒ∞stifad…ô ≈û…ôrtl…ôri":T?.title||"ƒ∞stifad…ô ≈û…ôrtl…ôri"}),e.jsx("p",{className:"text-blue-100 text-sm",children:y})]})]})}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:w?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Y√ºkl…ônir..."})]}):e.jsx("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:T?.content||"<p>ƒ∞stifad…ô ≈ü…ôrtl…ôri y√ºkl…ônm…ôdi.</p>"}})})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:b?.primary_color?`linear-gradient(135deg, ${b.primary_color}15 0%, ${b.secondary_color||b.primary_color}15 100%)`:"linear-gradient(135deg, #10b98115 0%, #065f4615 100%)"},children:[e.jsxs("button",{onClick:a,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{name:"close",size:16}),e.jsx("span",{children:"R…ôdd et"})]}),e.jsxs("button",{onClick:o,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",style:{background:b?.primary_color?`linear-gradient(135deg, ${b.primary_color} 0%, ${b.secondary_color||b.primary_color} 100%)`:"linear-gradient(135deg, #10b981 0%, #065f46 100%)",filter:"brightness(1)",":hover":{filter:"brightness(1.1)"}},onMouseEnter:j=>j.target.style.filter="brightness(1.1)",onMouseLeave:j=>j.target.style.filter="brightness(1)",children:[e.jsx(u,{name:"shield_check",size:16}),e.jsx("span",{children:"Q…ôbul edir…ôm"})]})]})]})]})}):null},At=({isOpen:d,onConfirm:o,onCancel:a,chatTitle:y="",siteName:b=""})=>{const{theme:s}=he();return d?e.jsx(re,{children:e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 bg-black/70 backdrop-blur-md",onClick:a}),e.jsxs(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,type:"spring",stiffness:300,damping:25},className:"relative z-50 bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-6 text-white",style:{background:s?.primary_color?`linear-gradient(135deg, ${s.primary_color} 0%, ${s.secondary_color||s.primary_color} 100%)`:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(u,{name:"warning",size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"S√∂hb…ôti Sil"}),e.jsx("p",{className:"text-blue-100 text-sm",children:b})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:e.jsx(u,{name:"warning",size:24,color:"#ef4444"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:"Bu s√∂hb…ôti silm…ôk ist…ôdiyinizd…ôn …ôminsiz?"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Bu …ôm…ôl geri alƒ±na bilm…ôz."})]})]}),y&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Silin…ôc…ôk s√∂hb…ôt:"}),e.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:['"',y,'"']})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-600 flex gap-3",style:{background:s?.primary_color?`linear-gradient(135deg, ${s.primary_color}10 0%, ${s.secondary_color||s.primary_color}10 100%)`:"linear-gradient(135deg, #ef444415 0%, #dc262615 100%)"},children:[e.jsxs("button",{onClick:a,className:"flex-1 px-4 py-3 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{name:"close",size:16}),e.jsx("span",{children:"L…ôƒüv et"})]}),e.jsxs("button",{onClick:o,className:"flex-1 px-4 py-3 text-white rounded-lg font-medium transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl bg-red-500 hover:bg-red-600",children:[e.jsx(u,{name:"delete",size:16}),e.jsx("span",{children:"Sil"})]})]})]})]})}):null},Et=({className:d="",chatbotName:o="AI Assistant"})=>{const{theme:a}=he(),y=a?.primary_color||"#6366f1",b=a?.text_color||"#1f2937";return e.jsxs("div",{className:`inline-flex items-center space-x-3 px-4 py-2 rounded-full ${d}`,style:{backgroundColor:`${y}10`},children:[e.jsxs("span",{className:"text-sm font-semibold",style:{color:b},children:[o," yazƒ±r"]}),e.jsxs("div",{className:"flex space-x-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full animate-pulse",style:{backgroundColor:y,animation:"typingDot1 1.8s infinite ease-in-out"}}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full animate-pulse",style:{backgroundColor:y,animation:"typingDot2 1.8s infinite ease-in-out"}}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full animate-pulse",style:{backgroundColor:y,animation:"typingDot3 1.8s infinite ease-in-out"}})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes typingDot1 {
          0%, 60%, 100% { transform: scale(1); opacity: 0.7; }
          30% { transform: scale(1.2); opacity: 1; }
        }
        @keyframes typingDot2 {
          0%, 60%, 100% { transform: scale(1); opacity: 0.7; }
          45% { transform: scale(1.2); opacity: 1; }
        }
        @keyframes typingDot3 {
          0%, 60%, 100% { transform: scale(1); opacity: 0.7; }
          60% { transform: scale(1.2); opacity: 1; }
        }
      `})]})},qt=({isOpen:d,onClose:o,isAuthenticated:a=!1})=>{const[y,b]=c.useState("color"),[s,f]=c.useState({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),[T,S]=c.useState(!1),w=at();c.useEffect(()=>{d&&v()},[d,a]);const v=async()=>{console.log("loadCurrentSettings called, isAuthenticated:",a);try{let r=null;if(a){console.log("Loading settings from API...");const g=await F.get("/api/user/background-settings");console.log("API response:",g.data),g.data.success?(r=g.data.settings,console.log("Loaded settings from API:",r),f(r)):(console.warn("API returned success=false"),r={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null,imageSize:"cover",imagePosition:"center"},f(r))}else{console.log("Loading settings from cookies...");const g=C("guest_background_settings");if(console.log("Cookie settings:",g),g)try{r=JSON.parse(g),console.log("Parsed cookie settings:",r),f(r)}catch(x){console.warn("Failed to parse guest background settings:",x),r={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},f(r)}else r={type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null},f(r)}console.log("Setting active tab based on settings type:",r?.type),r&&r.type==="image"?(console.log("Setting active tab to image because type is image"),b("image")):(console.log("Setting active tab to color because type is solid/gradient:",r?.type),b("color"))}catch(r){console.error("Error loading background settings:",r),f({type:"solid",color:"#f3f4f6",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",image:null}),b("color")}},C=r=>{const x=`; ${document.cookie}`.split(`; ${r}=`);return x.length===2?x.pop().split(";").shift():null},j=(r,g,x)=>{const z=new Date;z.setTime(z.getTime()+x*24*60*60*1e3),document.cookie=`${r}=${g};expires=${z.toUTCString()};path=/`},k=async()=>{console.log("handleSave called with settings:",s),S(!0);try{if(a){const r={type:s.type,color:s.type==="solid"?s.color:null,gradient:s.type==="gradient"?s.gradient:null,image:s.type==="image"?s.image:null,imageSize:s.type==="image"?s.imageSize:null,imagePosition:s.type==="image"?s.imagePosition:null};console.log("Sending save data:",r),console.log("Current settings:",s);const g=await F.post("/api/user/background-settings",r);console.log("Save response:",g.data),console.log("Current settings after save:",s),g.data.success?(w.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),N(),o()):(console.log("Save failed:",g.data),w.error("X…ôta ba≈ü verdi!"))}else j("guest_background_settings",JSON.stringify(s),70),w.success("Arxa fon parametrl…ôri saxlanƒ±ldƒ±!"),N(),o()}catch(r){console.error("Save error:",r),w.error("Saxlama zamanƒ± x…ôta ba≈ü verdi!")}finally{S(!1)}},N=()=>{console.log("applyBackground called with settings:",s);const r=document.querySelector("#chat-container, [data-chat-background]");if(console.log("Chat container found:",r),r){let g="";switch(s.type){case"solid":g=s.color||"#f3f4f6",console.log("Solid color background style:",g);break;case"gradient":g=s.gradient,console.log("Gradient background style:",g);break;case"image":if(s.image){let x=s.image;!x.startsWith("http")&&!x.startsWith("/")&&(x="/"+x),g=`url(${x})`,r.style.backgroundSize=s.imageSize||"cover",r.style.backgroundPosition=s.imagePosition||"center",r.style.backgroundRepeat="no-repeat",console.log("Applied image background:",{url:x,size:s.imageSize||"cover",position:s.imagePosition||"center"})}else g=s.color||"#f3f4f6";break;default:g="#f3f4f6"}console.log("Applying background style:",g),s.type==="image"?(r.style.setProperty("background-image",g,"important"),r.style.setProperty("background-size",s.imageSize||"cover","important"),r.style.setProperty("background-position",s.imagePosition||"center","important"),r.style.setProperty("background-repeat","no-repeat","important"),r.style.setProperty("background-color","","important")):(r.style.setProperty("background-image","","important"),r.style.setProperty("background-size","","important"),r.style.setProperty("background-position","","important"),r.style.setProperty("background-repeat","","important"),s.type==="gradient"?(r.style.setProperty("background",g,"important"),r.style.setProperty("background-color","","important")):s.type==="solid"?(r.style.setProperty("background","none","important"),r.style.setProperty("background-image","none","important"),r.style.setProperty("background-size","auto","important"),r.style.setProperty("background-position","0% 0%","important"),r.style.setProperty("background-repeat","repeat","important"),r.style.setProperty("background-attachment","scroll","important"),r.style.setProperty("background-origin","padding-box","important"),r.style.setProperty("background-clip","border-box","important"),r.style.setProperty("background-color",g,"important"),console.log("Applied solid color with full reset:",g)):(r.style.setProperty("background-color",g,"important"),r.style.setProperty("background","","important"))),window.dispatchEvent(new CustomEvent("backgroundChanged",{detail:{type:s.type,background:g,imageSize:s.imageSize,imagePosition:s.imagePosition}}))}else console.error("Chat container not found! Available elements:"),console.log("Elements with id chat-container:",document.querySelectorAll("#chat-container")),console.log("Elements with data-chat-background:",document.querySelectorAll("[data-chat-background]")),console.log("All divs on page:",document.querySelectorAll("div").length),console.log("Page body classes:",document.body.className)},L=async()=>{if(console.log("Delete image called, current settings:",s),!s.image){console.log("No image to delete");return}S(!0);try{console.log("Sending delete request to /api/user/background-image");const r=await F.delete("/api/user/background-image");console.log("Delete response:",r.data),r.data.success?(f(g=>({...g,image:null,imageSize:"cover",imagePosition:"center",type:"solid",color:"#f3f4f6"})),b("color"),w.success("≈û…ôkil silindi!")):w.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}catch(r){console.error("Delete error:",r),w.error("≈û…ôkil silin…ôrk…ôn x…ôta ba≈ü verdi!")}finally{S(!1)}},ae=async r=>{if(!r)return;if(r.size>400*1024){w.error("≈û…ôkil √∂l√ß√ºs√º 400KB-dan b√∂y√ºk ola bilm…ôz!");return}S(!0);const g=new FormData;g.append("image",r);try{const x=await F.post("/api/user/upload-background-image",g);if(x.data.success){console.log("Upload successful, URL:",x.data.url);const z={...s,image:x.data.url,imageSize:"cover",imagePosition:"center",type:"image"};f(z),w.success("≈û…ôkil y√ºkl…ôndi!")}else console.log("Upload failed:",x.data),w.error("≈û…ôkil y√ºkl…ônm…ôdi!")}catch(x){console.error("Upload error:",x),console.error("Upload error response:",x.response),x.response&&console.error("Upload error data:",x.response.data),w.error("≈û…ôkil y√ºkl…ônm…ô x…ôtasƒ±!")}finally{S(!1)}},be=[{name:"G√∂y-B…ôn√∂v≈ü…ôyi",value:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},{name:"√á…ôhrayƒ±-Narƒ±ncƒ±",value:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"},{name:"Ya≈üƒ±l-Mavi",value:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{name:"Qƒ±zƒ±l-Narƒ±ncƒ±",value:"linear-gradient(135deg, #ffa751 0%, #ff6b6b 100%)"},{name:"B…ôn√∂v≈ü…ôyi-√á…ôhrayƒ±",value:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"},{name:"T√ºnd Mavi",value:"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)"}];return d?e.jsx(re,{children:e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Arxa Fon Parametrl…ôri"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(u,{name:"close",size:20})})]}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>{b("color"),s.type==="image"&&f(r=>({...r,type:"solid"}))},className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${y==="color"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:"R…ông & Gradient"}),e.jsxs("button",{onClick:()=>{b("image"),s.image&&f(r=>({...r,type:"image"}))},disabled:!a,className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${y==="image"&&a?"text-purple-600 border-b-2 border-purple-600 bg-purple-50 dark:bg-purple-900/20":a?"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200":"text-gray-300 dark:text-gray-600 cursor-not-allowed"}`,children:["≈û…ôkil ",!a&&"üîí"]})]}),e.jsxs("div",{className:"p-6",children:[y==="color"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{console.log("Solid color selected");const r={...s,type:"solid"};f(r)},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${s.type==="solid"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Solid R…ông"}),e.jsx("button",{onClick:()=>{console.log("Gradient selected");const r={...s,type:"gradient"};f(r)},className:`flex-1 p-3 rounded-lg border-2 text-sm font-medium transition-all ${s.type==="gradient"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:"Gradient"})]}),s.type==="solid"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"R…ông se√ßin"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:s.color,onChange:r=>{console.log("Color changed to:",r.target.value);const g={...s,color:r.target.value,type:"solid"};f(g)},className:"w-16 h-12 rounded-lg border-2 border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:s.color,onChange:r=>{console.log("Color text changed to:",r.target.value);const g={...s,color:r.target.value,type:"solid"};f(g)},className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",placeholder:"#f3f4f6"})]})]}),s.type==="gradient"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"X√ºsusi Gradient CSS"}),e.jsx("textarea",{value:s.gradient,onChange:r=>{console.log("Gradient changed to:",r.target.value);const g={...s,gradient:r.target.value,type:"gradient"};f(g)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-mono text-sm h-20",placeholder:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hazƒ±r Gradientl…ôr"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:be.map((r,g)=>e.jsx("button",{onClick:()=>{const x={...s,gradient:r.value,type:"gradient"};f(x)},className:"text-xs px-3 py-2 border rounded-lg text-left hover:opacity-80 transition-opacity text-white font-medium",style:{background:r.value},children:r.name},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"√ñnizl…ôm…ô"}),e.jsx("div",{className:"w-full h-20 rounded-lg border-2 border-gray-200 flex items-center justify-center",style:{background:s.type==="solid"?s.color:s.gradient},children:e.jsx("span",{className:"bg-black/20 px-3 py-1 rounded text-white text-sm font-medium",children:"Arxa Fon N√ºmun…ôsi"})})]})]}),y==="image"&&e.jsx("div",{className:"space-y-4",children:a?e.jsxs(e.Fragment,{children:[s.image?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center bg-gray-50 dark:bg-gray-800",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("span",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"≈û…ôkil y√ºkl…ônib"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-500",children:"Ba≈üqa ≈ü…ôkil y√ºkl…ôm…ôk √º√ß√ºn m√∂vcud ≈ü…ôkili silin"})]}):e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üì∑"}),e.jsxs("label",{htmlFor:"background-image-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"≈û…ôkil y√ºkl…ôyin"}),e.jsx("span",{className:"block text-sm text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF (Maksimum 400KB)"}),e.jsx("input",{id:"background-image-upload",type:"file",accept:"image/*",className:"sr-only",onChange:r=>ae(r.target.files[0])})]})]}),s.image&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cari ≈û…ôkil"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-full h-40 rounded-lg border-2 border-gray-200 overflow-hidden",style:{backgroundImage:`url(${s.image})`,backgroundSize:s.imageSize||"cover",backgroundPosition:s.imagePosition||"center",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black/10",children:e.jsx("span",{className:"bg-white/90 px-2 py-1 rounded text-xs font-medium text-gray-700",children:"√ñnizl…ôm…ô"})})}),e.jsx("button",{onClick:L,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center text-sm hover:bg-red-600 transition-colors",title:"≈û…ôkili sil",children:"√ó"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil √ñl√ß√ºs√º"}),e.jsx("div",{className:"flex gap-2",children:["cover","contain","auto","100% 100%"].map(r=>e.jsx("button",{onClick:()=>{const g={...s,imageSize:r};f(g)},className:`px-3 py-1 text-xs rounded-lg border transition-colors ${(s.imageSize||"cover")===r?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-700":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-700 dark:text-gray-300"}`,children:r==="cover"?"Doldur":r==="contain"?"Sƒ±ƒüƒ±≈üdƒ±r":r==="auto"?"Orjinal":"Uzat"},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"≈û…ôkil M√∂vqeyi"}),e.jsx("div",{className:"grid grid-cols-3 gap-1 max-w-[120px]",children:[["top left","‚ÜñÔ∏è"],["top center","‚¨ÜÔ∏è"],["top right","‚ÜóÔ∏è"],["center left","‚¨ÖÔ∏è"],["center","‚≠ï"],["center right","‚û°Ô∏è"],["bottom left","‚ÜôÔ∏è"],["bottom center","‚¨áÔ∏è"],["bottom right","‚ÜòÔ∏è"]].map(([r,g])=>e.jsx("button",{onClick:()=>{const x={...s,imagePosition:r};f(x)},className:`w-8 h-8 text-xs rounded border flex items-center justify-center transition-colors ${(s.imagePosition||"center")===r?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-600":"border-gray-200 dark:border-gray-600 hover:border-gray-300 text-gray-500"}`,title:r,children:g},r))})]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"D…ôyi≈üiklikl…ôr real-time g√∂st…ôrilir"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üîí"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"≈û…ôkil Y√ºkl…ôm…ô Qadaƒüandƒ±r"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"≈û…ôkil y√ºkl…ôm…ôk √º√ß√ºn hesaba daxil olmalƒ±sƒ±nƒ±z"})]})})]}),e.jsxs("div",{className:"flex gap-2 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"L…ôƒüv et"}),e.jsx("button",{onClick:async()=>{f({type:"default",color:"transparent",gradient:"",image:null,imageSize:"cover",imagePosition:"center"});const g=document.querySelector("#chat-container, [data-chat-background]");g&&(g.style.setProperty("background","","important"),g.style.setProperty("background-image","","important"),g.style.setProperty("background-size","","important"),g.style.setProperty("background-position","","important"),g.style.setProperty("background-repeat","","important"),g.style.setProperty("background-color","","important"),g.style.setProperty("background-attachment","","important"),g.style.setProperty("background-origin","","important"),g.style.setProperty("background-clip","","important"));try{if(S(!0),console.log("Sending reset request with current settings:",s),a){const x={type:"default",color:null,gradient:null,image:null,imageSize:null,imagePosition:null};console.log("Sending reset data to API:",x);const z=await F.post("/api/user/background-settings",x);console.log("Reset API response:",z.data),z.data.success?(console.log("Reset successful - background and file should be deleted"),w.success("Arxa fon v…ô ≈ü…ôkil sƒ±fƒ±rlandƒ±!")):(console.error("Reset failed:",z.data),w.error("Sƒ±fƒ±rlama uƒüursuz oldu!"))}else document.cookie="guest_background_settings=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",w.success("Qonaq parametrl…ôri sƒ±fƒ±rlandƒ±!");setTimeout(()=>{v()},500),o()}catch(x){console.error("Reset error details:",x),console.error("Error response:",x.response?.data),w.error("Sƒ±fƒ±rlama zamanƒ± x…ôta ba≈ü verdi: "+(x.response?.data?.message||x.message))}finally{S(!1)}},disabled:T,className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors text-sm",title:"Defolt r…ông…ô qaytar",children:"Sƒ±fƒ±rlamaq"}),e.jsx("button",{onClick:k,disabled:T,className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg hover:from-purple-600 hover:to-indigo-700 disabled:opacity-50 transition-colors",children:T?"Saxlanƒ±r...":"Yadda Saxla"})]})]})})}):null},Ft=d=>{const a=`; ${document.cookie}`.split(`; ${d}=`);return a.length===2?a.pop().split(";").shift():null},rt=d=>{console.log("BackgroundLoader: applyBackgroundFromSettings called",d);const o=document.querySelector("#chat-container, [data-chat-background]");if(console.log("BackgroundLoader: Chat container found:",o),!o){console.error("BackgroundLoader: Chat container not found!");return}let a="";switch(d.type){case"solid":a=d.color||"transparent";break;case"gradient":a=d.gradient;break;case"image":if(d.image){let y=d.image;!y.startsWith("http")&&!y.startsWith("/")&&(y="/"+y),a=`url(${y})`,o.style.backgroundSize=d.imageSize||"cover",o.style.backgroundPosition=d.imagePosition||"center",o.style.backgroundRepeat="no-repeat",console.log("BackgroundLoader: Applied image background:",{url:y,size:d.imageSize||"cover",position:d.imagePosition||"center"})}else a=d.color||"#f3f4f6";break;default:a="transparent"}console.log("BackgroundLoader: Applying background style:",a),d.type==="image"?(o.style.backgroundImage=a,o.style.backgroundSize=d.imageSize||"cover",o.style.backgroundPosition=d.imagePosition||"center",o.style.backgroundRepeat="no-repeat",o.style.backgroundColor=""):(o.style.backgroundImage="",o.style.backgroundSize="",o.style.backgroundPosition="",o.style.backgroundRepeat="",d.type==="gradient"?(o.style.background=a,o.style.backgroundColor=""):d.type==="solid"?(o.style.setProperty("background","none","important"),o.style.setProperty("background-image","none","important"),o.style.setProperty("background-size","auto","important"),o.style.setProperty("background-position","0% 0%","important"),o.style.setProperty("background-repeat","repeat","important"),o.style.setProperty("background-attachment","scroll","important"),o.style.setProperty("background-origin","padding-box","important"),o.style.setProperty("background-clip","border-box","important"),o.style.setProperty("background-color",a,"important"),console.log("BackgroundLoader: Applied solid color with full reset:",a)):(o.style.backgroundColor=a,o.style.background=""))},Fe=async(d=!1)=>{console.log("BackgroundLoader: loadUserBackground called, isAuthenticated:",d);try{if(d){console.log("BackgroundLoader: Loading from API for authenticated user");const o=await fetch("/api/user/background-settings",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("BackgroundLoader: API response status:",o.status),o.ok){const a=await o.json();console.log("BackgroundLoader: API response data:",a),a.success?rt(a.settings):console.warn("BackgroundLoader: API returned success=false")}else console.error("BackgroundLoader: API request failed with status:",o.status)}else{const o=Ft("guest_background_settings");if(o)try{const a=JSON.parse(o);rt(a)}catch(a){console.warn("Failed to parse guest background settings:",a)}}}catch(o){console.warn("Failed to load user background:",o)}},Bt=({text:d,speed:o=50,onComplete:a})=>{const[y,b]=c.useState(""),[s,f]=c.useState(0);return c.useEffect(()=>{b(""),f(0)},[d]),c.useEffect(()=>{if(s<d.length){const T=setTimeout(()=>{b(S=>S+d[s]),f(S=>S+1)},o);return()=>clearTimeout(T)}else s===d.length&&s>0&&a&&a()},[s,d,o,a]),e.jsx("span",{children:y})},Ht=({content:d})=>e.jsx(zt,{remarkPlugins:[Tt],rehypePlugins:[Pt],components:{h1:({node:o,...a})=>e.jsx("h1",{className:"text-2xl font-bold mb-1 text-gray-800 dark:text-gray-100",...a}),h2:({node:o,...a})=>e.jsx("h2",{className:"text-xl font-semibold mb-1 text-gray-800 dark:text-gray-100",...a}),h3:({node:o,...a})=>e.jsx("h3",{className:"text-lg font-medium mb-1 text-gray-700 dark:text-gray-200",...a}),h4:({node:o,...a})=>e.jsx("h4",{className:"text-base font-medium mb-1 text-gray-700 dark:text-gray-200",...a}),p:({node:o,...a})=>e.jsx("p",{className:"mb-1 leading-normal text-gray-800 dark:text-gray-200",...a}),strong:({node:o,...a})=>e.jsx("strong",{className:"font-bold text-gray-900 dark:text-gray-100",...a}),em:({node:o,...a})=>e.jsx("em",{className:"italic text-gray-800 dark:text-gray-200",...a}),ul:({node:o,...a})=>e.jsx("ul",{className:"list-disc list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...a}),ol:({node:o,...a})=>e.jsx("ol",{className:"list-decimal list-inside mb-1 space-y-0.5 text-gray-800 dark:text-gray-200",...a}),li:({node:o,...a})=>e.jsx("li",{className:"text-gray-800 dark:text-gray-200",...a}),blockquote:({node:o,...a})=>e.jsx("blockquote",{className:"border-l-4 border-emerald-400 pl-4 py-1 mb-1 bg-emerald-50 dark:bg-emerald-900/30 text-gray-700 dark:text-gray-300",...a}),code:({node:o,inline:a,...y})=>a?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded text-sm font-mono text-gray-800 dark:text-gray-200",...y}):e.jsx("code",{className:"block bg-gray-100 dark:bg-gray-700 p-3 rounded-lg text-sm font-mono text-gray-800 dark:text-gray-200 overflow-x-auto",...y}),a:({node:o,...a})=>e.jsx("a",{className:"text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 underline",target:"_blank",rel:"noopener noreferrer",...a})},children:d});function Zt({auth:d,sessions:o=[],settings:a={},theme:y={},footerSettings:b={}}){const s=at(),{theme:f,isDarkMode:T,toggleDarkMode:S,refreshTheme:w}=he(),v=f||y,C={...v,isDarkMode:T,toggleDarkMode:S},[j,k]=c.useState(null),[N,L]=c.useState([]),[ae,be]=c.useState(""),[r,g]=c.useState(!1),[x,z]=c.useState(!1),[Be,V]=c.useState(!1),D=c.useRef(!1),M=c.useRef(0),[He,I]=c.useState(""),[fe,se]=c.useState([]),[Se,ke]=c.useState(o||[]);c.useEffect(()=>{ke(o||[])},[JSON.stringify(o)]);const[ne,st]=c.useState(!0),[nt,we]=c.useState(new Set),[A,Z]=c.useState(!1),[E,W]=c.useState(!1);c.useEffect(()=>{console.log("Sidebar state:",E,"Window width:",window.innerWidth)},[E]);const[Re,Ce]=c.useState(null),[ee,ot]=c.useState(new Map),[it,ve]=c.useState(!1),ze=c.useRef(null),[Ge,lt]=c.useState({top:0,left:0,align:"left"}),Oe=t=>{try{const i=t.getBoundingClientRect(),l=8,n=window.innerWidth,m=i.right+320<n,h=m?Math.max(8,i.left):Math.max(8,i.right-320),q=Math.min(window.innerHeight-200,i.bottom+l);lt({top:q,left:h,align:m?"left":"right"})}catch{}},[We,dt]=c.useState(()=>{try{const t=localStorage.getItem("feedbackGiven"),i=t?JSON.parse(t):[];return new Set(i.map(String))}catch{return new Set}}),ct=t=>{try{const i=new Set(We);i.add(String(t)),dt(i),localStorage.setItem("feedbackGiven",JSON.stringify([...i]))}catch{}},$=c.useRef(null),oe=c.useRef(null),[gt,Pe]=c.useState(!1),[mt,Te]=c.useState(!1),[R,Y]=c.useState(!0),[ut,De]=c.useState(!1),[U,Me]=c.useState(null),[X,je]=c.useState(()=>{const t=Number(localStorage.getItem("messageFontScale"));return t&&t>=.85&&t<=1.4?t:1}),[pt,xt]=c.useState(!1),[Ie,Ne]=c.useState(new Map),[Ue,yt]=c.useState(null),[ht,Xe]=c.useState(!1);c.useEffect(()=>{try{localStorage.setItem("messageFontScale",String(X))}catch{}},[X]);const bt=async()=>{if(U)try{if(d?.user){const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content");try{await F.delete(`/chat/${U.session_id}`,{headers:{"X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}})}catch{await F.post(`/chat/${U.session_id}/delete`,{},{headers:{"X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}})}ke(i=>i.filter(l=>l.session_id!==U.session_id)),j===U.session_id&&(k(null),L([]))}else{const i=JSON.parse(localStorage.getItem("guestChatSessions")||"[]").filter(l=>l.session_id!==U.session_id);localStorage.setItem("guestChatSessions",JSON.stringify(i)),se(i),j===U.session_id&&(k(null),L([]))}s.success("S√∂hb…ôt silindi!")}catch(t){console.error("Delete session error:",t),s.error("S√∂hb…ôt silin…ôrk…ôn x…ôta ba≈ü verdi")}finally{De(!1),Me(null)}},ft=()=>{De(!1),Me(null)},[B,$e]=c.useState({allowed:!0,remaining:0,daily_remaining:0,monthly_remaining:0,reset_time:null,monthly_reset_time:null,user_type:"guest"}),[ie,Le]=c.useState(!1),[le,Ae]=c.useState(null),Je=a.chatbot_name||"AI Assistant",de=a.site_name||"XIV AI Chatbot Platform",kt=a.chat_disclaimer_text||"√áatbotun cavablarƒ±nƒ± yoxlayƒ±n, s…ôhv ed…ô bil…ôr!",te=Number(a.message_input_limit||a.guest_input_limit||500),ce=a.ai_response_type||"typewriter",wt=Number(a.ai_typing_speed||50),Ke=Number(a.ai_thinking_time||1e3),J=!d?.user,ge=ae.length,Ye=te-ge,Q=te>0&&ge>te,_=v?.primary_color||y?.primary_color||"#17cf1a",K=v?.secondary_color||y?.secondary_color||"#179207";v?.accent_color||y?.accent_color,v?.background_gradient||y?.background_gradient,v?.text_color||y?.text_color;const _e=(()=>{const t=typeof window<"u"?window.innerWidth<768:!1,i=C.isDarkMode,l=a||{},n=l.brand_logo_desktop_light,m=l.brand_logo_desktop_dark,h=l.brand_logo_mobile_light,q=l.brand_logo_mobile_dark;if(t){if(i&&q)return q;if(!i&&h)return h}else{if(i&&m)return m;if(!i&&n)return n}return l.brand_logo_url||""})(),Ee=(()=>{const t=v?.chat_background_type;if(!t||t==="default"||t===null)return"transparent";switch(t){case"solid":return v?.chat_background_color||"transparent";case"gradient":return v?.chat_background_gradient||"transparent";case"image":return v?.chat_background_image?`url(${v.chat_background_image})`:"transparent";default:return"transparent"}})(),Qe=t=>{if(!t)return"";const l=t-new Date;if(l<=0)return"Yenil…ônir...";const n=Math.floor(l/(1e3*60*60)),m=Math.floor(l%(1e3*60*60)/(1e3*60)),h=Math.floor(l%(1e3*60)/1e3);return n>0?`${n} saat ${m} d…ôqiq…ô ${h} saniy…ô`:m>0?`${m} d…ôqiq…ô ${h} saniy…ô`:`${h} saniy…ô`},me=async()=>{try{const i=await(await fetch(`/api/chat-limits?t=${Date.now()}`,{cache:"no-store"})).json();$e(i),i.allowed?(Le(!1),(mt||d?.user)&&Y(!1)):(Le(!0),Y(!0),i.reset_time&&Ae(new Date(i.reset_time)))}catch(t){console.error("Failed to fetch limits:",t)}};c.useEffect(()=>{if(d?.user)Y(!1),Te(!0);else{const t=JSON.parse(localStorage.getItem("guestChatSessions")||"[]");se(t),localStorage.getItem("guest-terms-accepted")==="true"?(Te(!0),Y(!1)):(Pe(!0),Y(!0))}me()},[d?.user]),c.useEffect(()=>{me();const t=setInterval(me,3e4),i=setInterval(()=>{le&&le-new Date<=0&&(me(),Ae(null))},1e3);return()=>{clearInterval(t),clearInterval(i)}},[le]),c.useEffect(()=>{const t=()=>{w&&w(),me()};return window.addEventListener("focus",t),()=>window.removeEventListener("focus",t)},[w]),c.useEffect(()=>{const t=setTimeout(()=>{Fe(!!d?.user),setTimeout(()=>{const l=document.querySelector("#chat-container, [data-chat-background]");l&&!l.style.backgroundImage&&!l.style.background&&(console.log("Chat background retry - first attempt may have failed"),Fe(!!d?.user))},1e3)},500),i=l=>{if(l.detail&&l.detail.background){const n=document.querySelector("#chat-container, [data-chat-background]");n&&(l.detail.type==="image"?(n.style.backgroundImage=l.detail.background,n.style.backgroundSize=l.detail.imageSize||"cover",n.style.backgroundPosition=l.detail.imagePosition||"center",n.style.backgroundRepeat="no-repeat",n.style.backgroundColor=""):(n.style.backgroundImage="",n.style.backgroundSize="",n.style.backgroundPosition="",n.style.backgroundRepeat="",l.detail.type==="gradient"?(n.style.background=l.detail.background,n.style.backgroundColor=""):l.detail.type==="solid"?(n.style.setProperty("background","none","important"),n.style.setProperty("background-image","none","important"),n.style.setProperty("background-size","auto","important"),n.style.setProperty("background-position","0% 0%","important"),n.style.setProperty("background-repeat","repeat","important"),n.style.setProperty("background-attachment","scroll","important"),n.style.setProperty("background-origin","padding-box","important"),n.style.setProperty("background-clip","border-box","important"),n.style.setProperty("background-color",l.detail.background,"important"),console.log("Chat listener applied solid color:",l.detail.background)):(n.style.backgroundColor=l.detail.background,n.style.background="")))}setTimeout(()=>Fe(!!d?.user),200)};return window.addEventListener("backgroundChanged",i),()=>{clearTimeout(t),window.removeEventListener("backgroundChanged",i)}},[d?.user]);const Ve=(t,i,l)=>{if(!d?.user){const n={session_id:t,title:i||t.slice(0,8),messages:l||[],created_at:new Date().toISOString()},m=JSON.parse(localStorage.getItem("guestChatSessions")||"[]"),h=m.findIndex(P=>P.session_id===t);h>=0?m[h]={...m[h],messages:l}:m.unshift(n);const q=m.slice(0,10);localStorage.setItem("guestChatSessions",JSON.stringify(q)),se(q)}},vt=async t=>{if(d?.user)try{const{data:i}=await F.get(`/chat/${t}`);L(i.messages)}catch(i){s.error("S√∂hb…ôt y√ºkl…ônm…ôdi"),console.error("loadSession error:",i)}else{const i=fe.find(l=>l.session_id===t);i&&L(i.messages||[])}k(t)},jt=()=>{localStorage.setItem("guest-terms-accepted","true"),Te(!0),ie||Y(!1),Pe(!1),s.success("ƒ∞stifad…ô ≈ü…ôrtl…ôri q…ôbul edildi! ƒ∞ndi √ßatbotla danƒ±≈üa bil…ôrsiniz.")},Nt=()=>{Pe(!1),Y(!0),s.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn √ßatbotla danƒ±≈üa bilm…ôzsiniz.")},Ze=async()=>{if(!ae.trim())return;if(A){s.warning("√áatbot h…ôl…ô d…ô yazƒ±r. Z…ôhm…ôt olmasa g√∂zl…ôyin.");return}if(R){s.warning("ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul etm…ôd…ôn mesaj g√∂nd…ôr…ô bilm…ôzsiniz.");return}if(Q){s.warning(`Daxiletm…ô limiti: ${te}. Cari: ${ge} simvol`);return}const t={role:"user",content:ae,created_at:new Date().toISOString()};L(n=>[...n,{...t,id:`local-${Date.now()}`}]),be("");try{oe.current&&(oe.current.style.height="")}catch{}g(!0),z(!0),V(!0),D.current=!0,I("Sual g√∂nd…ôrildi...");const i=++M.current;try{clearTimeout(window.__ragPhaseTimer1),clearTimeout(window.__ragPhaseTimer2),clearTimeout(window.__ragPhaseTimer3),clearTimeout(window.__ragPhaseTimer4)}catch{}window.__ragPhaseTimer1=setTimeout(()=>{M.current===i&&D.current&&I("Embeddings hazƒ±rlanƒ±r...")},300),window.__ragPhaseTimer2=setTimeout(()=>{M.current===i&&D.current&&I("Vektor maƒüazasƒ±nda axtarƒ±≈ü...")},900),window.__ragPhaseTimer3=setTimeout(()=>{M.current===i&&D.current&&I("Kontekst toplanƒ±r...")},1500),window.__ragPhaseTimer4=setTimeout(()=>{M.current===i&&D.current&&I("Cavab formala≈üdƒ±rƒ±lƒ±r...")},2100);const l=new AbortController;Ce(l);try{const{data:n}=await F.post("/chat/send",{message:t.content,session_id:j},{signal:l.signal});if(!j){k(n.session_id);const P=t.content.slice(0,40),G=new Date().toISOString();if(d?.user){ke(pe=>[{session_id:n.session_id,title:"",created_at:G},...pe]);let O=0;const ue=setInterval(()=>{O++;const pe=P.slice(0,O);ke(xe=>xe.map(ye=>ye.session_id===n.session_id?{...ye,title:pe}:ye)),O>=P.length&&clearInterval(ue)},Math.max(20,Math.min(80,1e3/Math.max(5,P.length))))}else{const O={session_id:n.session_id,title:"",created_at:G,messages:[t]};se(xe=>[O,...xe]);let ue=0;const pe=setInterval(()=>{ue++;const xe=P.slice(0,ue);se(ye=>ye.map(qe=>qe.session_id===n.session_id?{...qe,title:xe}:qe)),ue>=P.length&&clearInterval(pe)},Math.max(20,Math.min(80,1e3/Math.max(5,P.length))))}}const m=`ai-${Date.now()}`;let h;if(ce==="instant"){V(!1),D.current=!1,z(!1),I(""),M.current++,h={role:"assistant",content:n.message,fullContent:n.message,id:m,created_at:new Date().toISOString(),isTyping:!1,ragMeta:n.rag?.metadata||null,isContinuation:!!n.continuation};const P=[...N,t,h];L(G=>[...G,h])}else V(!1),D.current=!1,z(!1),I(""),M.current++,h={role:"assistant",content:"",fullContent:n.message,id:m,created_at:new Date().toISOString(),isTyping:!0,ragMeta:n.rag?.metadata||null,isContinuation:!!n.continuation},L(P=>[...P,h]),Z(!0),setTimeout(()=>{we(P=>new Set([...P,m]))},Ke);const q=[...N,t,h];if(!d?.user){const P=j||n.session_id;Ve(P,t.content,q)}n.limit_info&&$e({allowed:n.limit_info.remaining>0,remaining:n.limit_info.remaining,daily_remaining:n.limit_info.daily_remaining,monthly_remaining:n.limit_info.monthly_remaining,reset_time:n.limit_info.reset_time,monthly_reset_time:n.limit_info.monthly_reset_time,user_type:d?.user?"user":"guest"})}catch(n){if(n.name==="CanceledError")s.info("Mesaj g√∂nd…ôrm…ô dayandƒ±rƒ±ldƒ±");else if(n.response?.status===429){const m=n.response.data;s.error(m.error||"Mesaj limiti dolmu≈üdur!"),m.limit_exceeded&&(Le(!0),Y(!0),m.reset_time&&Ae(new Date(m.reset_time)),$e({allowed:!1,remaining:m.remaining||0,daily_remaining:m.daily_remaining||0,monthly_remaining:m.monthly_remaining||0,reset_time:m.reset_time,monthly_reset_time:m.monthly_reset_time,user_type:d?.user?"user":"guest"}))}else s.error(n.response?.data?.error||"X…ôta ba≈ü verdi");Z(!1)}finally{g(!1),Ce(null),setTimeout(()=>{z(!1),V(!1),D.current=!1,M.current++,ce==="instant"&&Z(!1)},600),setTimeout(()=>$.current?.scrollTo({top:$.current.scrollHeight,behavior:"smooth"}),50),setTimeout(()=>$.current?.scrollTo({top:$.current.scrollHeight,behavior:"smooth"}),50)}},_t=t=>{const i=N.findIndex(l=>(l.id||"")===(t.id||""));for(let l=i-1;l>=0;l--)if(N[l]?.role==="user"&&typeof N[l].content=="string")return N[l].content;for(let l=N.length-1;l>=0;l--)if(N[l]?.role==="user")return N[l].content;return"Davam et"},St=async t=>{if(!t?.ragMeta?.dominant_kb_id)return;if(A){s.warning("√áatbot h…ôl…ô d…ô yazƒ±r. Z…ôhm…ôt olmasa g√∂zl…ôyin.");return}const i=t.ragMeta.dominant_kb_id,l=t.ragMeta.max_used_chunk_index_for_dominant??-1,n=_t(t);g(!0),z(!0),V(!0),D.current=!0,I("Davamƒ± hazƒ±rlanƒ±r...");const m=++M.current;try{clearTimeout(window.__ragPhaseTimer1),clearTimeout(window.__ragPhaseTimer2),clearTimeout(window.__ragPhaseTimer3),clearTimeout(window.__ragPhaseTimer4)}catch{}window.__ragPhaseTimer1=setTimeout(()=>{M.current===m&&D.current&&I("Embeddings hazƒ±rlanƒ±r...")},300),window.__ragPhaseTimer2=setTimeout(()=>{M.current===m&&D.current&&I("Vektor maƒüazasƒ±nda axtarƒ±≈ü...")},900),window.__ragPhaseTimer3=setTimeout(()=>{M.current===m&&D.current&&I("Kontekst toplanƒ±r...")},1500),window.__ragPhaseTimer4=setTimeout(()=>{M.current===m&&D.current&&I("Cavab formala≈üdƒ±rƒ±lƒ±r...")},2100);try{const{data:h}=await F.post("/chat/send",{message:n,session_id:j,continue:!0,kb_id:i,start_after_index:l}),q=`ai-${Date.now()}`;V(!1),D.current=!1,z(!1),I(""),M.current++;const P={role:"assistant",content:"",fullContent:h.message,id:q,created_at:new Date().toISOString(),isTyping:ce!=="instant",ragMeta:h.rag?.metadata||null,isContinuation:!0};L(G=>[...G,P]),ce==="instant"?(L(G=>G.map(O=>O.id===q?{...O,content:O.fullContent,isTyping:!1}:O)),I("Cavab hazƒ±rlandƒ±.")):(Z(!0),setTimeout(()=>{we(G=>new Set([...G,q])),I("Cavab yazƒ±lƒ±r...")},Ke))}catch(h){s.error(h.response?.data?.error||"X…ôta ba≈ü verdi")}finally{g(!1),setTimeout(()=>{z(!1),V(!1),D.current=!1,M.current++,ce==="instant"&&Z(!1)},600),setTimeout(()=>$.current?.scrollTo({top:$.current.scrollHeight,behavior:"smooth"}),50)}},et=async()=>{Re&&(Re.abort(),Ce(null));try{await F.post("/chat/stop")}catch{}g(!1),z(!1),Z(!1),we(new Set),s.info("Cavab yazmaq dayandƒ±rƒ±ldƒ±")},tt=async(t,i,l)=>{ct(t);try{ot(m=>{const h=new Map(m);return h.set(t,l),h}),await F.post("/chat/feedback",{message_id:t,session_id:j,message_content:i,feedback_type:l});const n=l==="like"?"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, bu bizi sevindirir. :)":"R…ôyiniz √º√ß√ºn t…ô≈ü…ôkk√ºr edirik, biz √ßatbotu t…ôkmil…ô≈üdir…ôc…ôyik, z…ôif t…ôcr√ºb…ômiz √º√ß√ºn √ºzr ist…ôyirik.";s.success(n)}catch(n){console.error("Feedback error:",n);const m=n?.response?.data?.error||"B…ôy…ôn/B…ôy…ônm…ô g√∂nd…ôrilm…ôdi";s.error(m)}},Ct=t=>{t.key==="Enter"&&ne&&!t.shiftKey&&(t.preventDefault(),r||A?et():!R&&!A&&Ze())};return c.useEffect(()=>{$.current&&($.current.scrollTop=$.current.scrollHeight)},[N]),c.useEffect(()=>{$.current&&$.current.scrollTo({top:$.current.scrollHeight,behavior:"smooth"})},[N]),c.useEffect(()=>{if($.current&&A){const t=setInterval(()=>{try{const i=$.current;i.scrollTop=i.scrollHeight}catch{}},150);return()=>clearInterval(t)}},[A,N]),c.useEffect(()=>{const t=i=>{ze.current&&!ze.current.contains(i.target)&&ve(!1)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[]),c.useEffect(()=>{const t=i=>{i.key==="Escape"&&E&&W(!1)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[E]),c.useEffect(()=>(E&&window.innerWidth<768?(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"):(document.body.style.overflow="",document.body.style.paddingRight=""),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[E]),c.useEffect(()=>{const t=()=>{window.innerWidth>=768&&E&&(console.log("Desktop-a ke√ßildi, sidebar baƒülanƒ±r"),W(!1))};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[E]),e.jsx("div",{className:`${C.isDarkMode?"dark":""}`,children:e.jsxs("div",{className:"min-h-screen flex flex-col overflow-x-hidden",style:{background:C.isDarkMode?v?.dark_background_gradient||"linear-gradient(135deg, #1f2937 0%, #111827 100%)":v?.background_gradient||"linear-gradient(135deg, #f9fafb 0%, #ffffff 100%)",backgroundAttachment:"fixed",minHeight:"100dvh"},children:[e.jsx(Dt,{title:`∆èsas s…ôhif…ô - ${de}`}),e.jsxs("div",{className:"w-full px-4 md:px-4 lg:px-6 py-4 md:py-4 lg:py-6 flex-1 flex flex-col min-h-0 pb-24",children:[e.jsxs(p.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"mb-4 md:mb-6 flex flex-wrap items-center justify-between bg-gradient-to-r from-white/95 via-white/90 to-white/95 dark:from-gray-800/95 dark:via-gray-800/90 dark:to-gray-800/95 backdrop-blur-xl rounded-3xl p-4 md:p-6 shadow-2xl shadow-purple-500/10 dark:shadow-purple-500/20 w-full border border-white/20 dark:border-gray-700/50 hover:shadow-3xl transition-all duration-300",children:[e.jsxs(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"flex items-start md:items-center gap-3",children:[e.jsx(p.button,{whileHover:{scale:1.05,rotate:5},whileTap:{scale:.95},onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("Toggle button clicked:",!E),W(!E)},onTouchStart:t=>{t.preventDefault(),t.stopPropagation(),console.log("Toggle touch start")},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation();const i=!E;console.log("Toggle touch end, changing state from",E,"to",i),W(i)},className:"md:hidden p-3 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 text-gray-700 dark:text-gray-300 hover:from-purple-500/20 hover:to-indigo-500/20 border border-purple-200/30 dark:border-purple-700/30 backdrop-blur-sm transition-all duration-300 shadow-lg hover:shadow-xl","aria-label":"S√∂hb…ôt tarix√ß…ôsi",type:"button",style:{touchAction:"manipulation",WebkitTouchCallout:"none",WebkitUserSelect:"none"},children:e.jsx(u,{name:"menu",size:20})}),e.jsxs(p.h1,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"hidden md:flex text-lg md:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 dark:from-gray-100 dark:via-gray-200 dark:to-gray-100 bg-clip-text text-transparent items-center gap-3 hover:from-purple-600 hover:via-indigo-600 hover:to-purple-600 transition-all duration-500",children:[a.brand_mode==="logo"&&(_e||a.brand_logo_url)?e.jsx(p.img,{whileHover:{scale:1.1,rotate:5},src:_e||a.brand_logo_url,alt:"logo",className:"w-8 h-8 md:w-10 md:h-10 object-contain rounded-xl shadow-lg border border-white/20 dark:border-gray-700/50"}):a.brand_mode==="icon"?e.jsx(p.div,{whileHover:{scale:1.1,rotate:5},className:"p-2 rounded-xl bg-gradient-to-br from-purple-500/10 to-indigo-500/10 border border-purple-200/30 dark:border-purple-700/30 shadow-lg",children:e.jsx(u,{name:a.brand_icon_name||"nav_chat",size:28,color:_})}):null,e.jsx(p.span,{whileHover:{scale:1.02},className:"truncate font-extrabold tracking-wide",children:de})]}),e.jsxs("div",{className:"md:hidden flex flex-col gap-1 ml-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[12px] font-medium text-gray-700 dark:text-gray-300",ref:ze,children:[e.jsx(u,{name:"limit",size:18}),e.jsxs("span",{children:[B.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz"]}),e.jsx("span",{className:"text-white px-2 py-0.5 rounded-full",style:{backgroundColor:_},children:B.remaining})," sorƒüu",e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),Oe(t.currentTarget),ve(i=>!i)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(u,{name:"limit_info",size:18})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"sun",size:16,color:C.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.isDarkMode,onChange:()=>C.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(u,{name:"moon",size:16,color:C.isDarkMode?"#60a5fa":"#9ca3af"})]})]})]}),e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},className:"hidden md:flex items-center gap-3 flex-wrap justify-end",children:[e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:`relative px-4 py-2 rounded-xl text-xs font-semibold backdrop-blur-sm border shadow-lg transition-all duration-300 ${ie?"bg-gradient-to-r from-red-50 to-red-100 text-red-800 border-red-200 shadow-red-200/50":B.remaining<=5?"bg-gradient-to-r from-yellow-50 to-yellow-100 text-yellow-800 border-yellow-200 shadow-yellow-200/50":"bg-gradient-to-r from-green-50 to-green-100 text-green-800 border-green-200 shadow-green-200/50"}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:ie?"warning":"limit",size:12}),e.jsx("span",{children:ie?e.jsxs(e.Fragment,{children:["M…ôhdudiyy…ôt! - ",Qe(le)]}):e.jsxs(e.Fragment,{children:[B.limit_type==="monthly"?"Aylƒ±q":"G√ºnl√ºk"," limitiniz ",B.remaining," sorƒüu(√ßƒ±xƒ±≈ü)"]})}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),Oe(t.currentTarget),ve(i=>!i)},className:"ml-1 p-1 rounded-md text-gray-800 hover:text-black hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-110",title:"Limit haqqƒ±nda",children:e.jsx(u,{name:"limit_info",size:18})})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx(u,{name:"sun",size:16,color:C.isDarkMode?"#9ca3af":"#fbbf24"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.isDarkMode,onChange:()=>C.toggleDarkMode(),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]}),e.jsx(u,{name:"moon",size:16,color:C.isDarkMode?"#60a5fa":"#9ca3af"})]}),d?.user?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden md:inline text-sm text-gray-600 dark:text-gray-300",children:["Salam, ",d.user.name]}),d.user.role?.name==="admin"&&e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/admin",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"settings",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Admin Panel"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/profile",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 hover:from-gray-200 hover:to-gray-300 dark:from-gray-600 dark:to-gray-700 dark:text-gray-200 dark:hover:from-gray-500 dark:hover:to-gray-600 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Profil"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/logout",method:"post",as:"button",className:"px-4 py-2.5 rounded-xl text-sm bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",children:[e.jsx(u,{name:"logout",size:16}),e.jsx("span",{className:"hidden md:inline",children:"√áƒ±xƒ±≈ü"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/login",className:"px-4 py-2.5 rounded-xl text-sm bg-white/80 backdrop-blur-sm border-2 text-emerald-700 hover:bg-emerald-50 hover:border-emerald-300 dark:bg-gray-800/80 dark:text-emerald-400 dark:hover:bg-gray-700 dark:border-gray-600 dark:hover:border-emerald-500 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 font-medium",style:{borderColor:_},children:[e.jsx(u,{name:"users",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Daxil ol"})]})}),e.jsx(p.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(H,{href:"/register",className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:scale-105",style:{background:`linear-gradient(135deg, ${_}DD, ${K}DD)`},children:[e.jsx(u,{name:"user_add",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Qeydiyyat"})]})})]}),e.jsxs(p.button,{whileHover:{scale:1.05,rotate:2},whileTap:{scale:.95},onClick:()=>{k(null),L([])},className:"px-4 py-2.5 rounded-xl text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:brightness-110",style:{background:`linear-gradient(135deg, ${K}DD, ${_}DD)`},children:[e.jsx(u,{name:"edit",size:16}),e.jsx("span",{className:"hidden md:inline",children:"Yeni s√∂hb…ôt"})]})]}),e.jsxs("div",{className:"flex md:hidden items-center gap-2 ml-auto overflow-x-auto",children:[d?.user?e.jsxs(e.Fragment,{children:[d.user.role?.name==="admin"&&e.jsx(H,{href:"/admin",className:"px-2 py-2 rounded-lg text-sm bg-purple-600 text-white hover:bg-purple-700 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"settings",size:16})}),e.jsx(H,{href:"/profile",className:"px-2 py-2 rounded-lg text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"users",size:16})}),e.jsx(H,{href:"/logout",method:"post",as:"button",className:"px-2 py-2 rounded-lg text-sm bg-red-500 text-white hover:bg-red-600 transition-colors shadow-sm flex items-center gap-1",children:e.jsx(u,{name:"logout",size:16})})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{href:"/login",className:"px-2 py-2 rounded-lg text-sm bg-white border text-emerald-700 hover:bg-emerald-50 dark:bg-gray-800 dark:text-emerald-400 dark:hover:bg-gray-700 transition-colors shadow-sm flex items-center gap-1",style:{borderColor:_},children:e.jsx(u,{name:"users",size:16})}),e.jsx(H,{href:"/register",className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:_},children:e.jsx(u,{name:"user_add",size:16})})]}),e.jsx("button",{onClick:()=>{k(null),L([])},className:"px-2 py-2 rounded-lg text-sm text-white transition-colors shadow-sm flex items-center gap-1",style:{backgroundColor:K},title:"Yeni s√∂hb…ôt",children:e.jsx(u,{name:"edit",size:16})})]})]}),e.jsxs("div",{className:"flex gap-0 md:gap-4 h-full",children:[e.jsx(re,{children:E&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 md:hidden",onTouchStart:t=>{t.preventDefault(),W(!1)},onClick:()=>W(!1)})}),e.jsx(re,{children:(E||window.innerWidth>=768)&&e.jsxs(p.aside,{initial:{x:window.innerWidth<768?-320:0,opacity:window.innerWidth<768?0:1},animate:{x:0,opacity:1},exit:{x:-320,opacity:0},transition:{type:"spring",stiffness:400,damping:25,mass:.6,duration:.4},className:`
                  fixed md:relative
                  top-0 left-0
                  h-full
                  w-80 md:w-72 lg:w-80
                  bg-gradient-to-b from-white via-white to-gray-50 dark:from-gray-800 dark:via-gray-800 dark:to-gray-900
                  backdrop-blur-xl
                  border-r border-gray-200 dark:border-gray-700
                  rounded-r-3xl md:rounded-3xl
                  z-50 md:z-auto
                  flex flex-col
                  shadow-2xl md:shadow-xl
                `,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(p.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.15,duration:1,type:"spring",stiffness:200,damping:20},className:"md:hidden p-4 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-900/20 dark:to-purple-900/20 border-b border-gray-100 dark:border-gray-700/50 rounded-tr-3xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[a.brand_mode==="logo"&&(_e||a.brand_logo_url)?e.jsx(p.img,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.3,duration:.8,type:"spring",stiffness:200},whileHover:{scale:1.1,rotate:5,transition:{duration:.2}},whileTap:{scale:.95},src:_e||a.brand_logo_url,alt:"logo",className:"w-7 h-7 object-contain rounded-lg shadow-md border border-white/30 dark:border-gray-600/50"}):a.brand_mode==="icon"?e.jsx(p.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.3,duration:.8,type:"spring",stiffness:200},whileHover:{scale:1.1,rotate:5,transition:{duration:.2}},whileTap:{scale:.95},className:"p-1.5 rounded-lg bg-gradient-to-br from-purple-500/15 to-indigo-500/15 border border-purple-200/40 dark:border-purple-700/40 shadow-md",children:e.jsx(u,{name:a.brand_icon_name||"nav_chat",size:20,color:_})}):null,e.jsx(p.span,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.5,duration:.8,type:"spring",stiffness:150},whileHover:{scale:1.02,x:2,transition:{duration:.2}},className:"font-bold text-lg bg-gradient-to-r from-gray-800 via-gray-700 to-gray-800 dark:from-gray-100 dark:via-gray-200 dark:to-gray-100 bg-clip-text text-transparent truncate leading-tight",children:de})]})}),e.jsxs(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between bg-gradient-to-r from-purple-50/30 to-indigo-50/30 dark:from-purple-900/10 dark:to-indigo-900/10 md:rounded-t-3xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p.div,{whileHover:{scale:1.1,rotate:5},children:e.jsx(u,{name:"chat_history",size:24,color:_})}),e.jsx("h2",{className:"text-sm font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wider",children:"S√∂hb…ôt Tarix√ß…ôsi"})]}),e.jsx(p.button,{whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},onTouchStart:t=>{t.preventDefault(),t.stopPropagation(),W(!1)},onClick:t=>{t.preventDefault(),t.stopPropagation(),W(!1)},className:"md:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors active:bg-gray-200 dark:active:bg-gray-600 shadow-sm",type:"button","aria-label":"Baƒüla",children:e.jsx(u,{name:"close",size:20})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-1 custom-scrollbar",children:[(d?.user?Se:fe).map((t,i)=>e.jsx(p.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:i*.05,duration:.3},whileHover:{scale:1.02,x:4},whileTap:{scale:.98},onClick:()=>{vt(t.session_id),window.innerWidth<768&&W(!1)},className:`
                        group w-full text-left px-3 py-2.5 rounded-xl transition-all
                        ${j===t.session_id?"bg-gradient-to-r from-emerald-50 to-emerald-100/50 dark:from-gray-700 dark:to-gray-600 border-l-4 shadow-md":"hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:shadow-sm"}
                      `,style:j===t.session_id?{borderLeftColor:_}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:t.title||t.session_id.slice(0,8)}),t.created_at&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:new Date(t.created_at).toLocaleDateString("az")})]}),e.jsx(p.button,{whileHover:{scale:1.2},whileTap:{scale:.9},onClick:l=>{l.stopPropagation(),Me(t),De(!0)},className:"opacity-0 group-hover:opacity-100 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-all",title:"S√∂hb…ôti sil",children:e.jsx(u,{name:"close",size:16,className:"text-red-500"})})]})},t.session_id)),(d?.user?Se:fe).length===0&&e.jsxs(p.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2},className:"text-center py-12",children:[e.jsx(u,{name:"chat",size:48,color:C.isDarkMode?"#6b7280":"#d1d5db",className:"mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"He√ß bir s√∂hb…ôt yoxdur"})]})]}),e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gradient-to-r from-purple-50/30 to-indigo-50/30 dark:from-purple-900/10 dark:to-indigo-900/10 rounded-br-3xl md:rounded-b-3xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{name:"chat",size:18,color:_}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"√úmumi s√∂hb…ôtl…ôr"})]}),e.jsx(p.div,{whileHover:{scale:1.15},className:"flex items-center justify-center min-w-[28px] h-7 px-2.5 rounded-full text-xs font-bold text-white shadow-lg",style:{backgroundColor:_},children:(d?.user?Se:fe).length})]})})]})}),e.jsx("div",{className:"flex-1 min-w-0 w-full",children:e.jsx("main",{className:"w-full max-w-none",children:e.jsxs("div",{className:`w-full backdrop-blur-xl border border-emerald-200 dark:border-gray-600 rounded-3xl p-3 md:p-6 flex flex-col shadow-2xl hover:shadow-3xl dark:shadow-purple-500/10 border-white/20 dark:border-gray-700/30 transition-all duration-300 relative ${Ee==="transparent"?"bg-white/95 dark:!bg-gray-800/95":"dark:!bg-gray-800/95"}`,"data-chat-background":"true",id:"chat-container",style:{minHeight:"calc(100vh - 200px)",background:Ee!=="transparent"?Ee:void 0,backgroundSize:v?.chat_background_type==="image"?"cover":void 0,backgroundPosition:v?.chat_background_type==="image"?"center":void 0,backgroundRepeat:v?.chat_background_type==="image"?"no-repeat":void 0},children:[e.jsxs("div",{className:"absolute top-2 right-2 z-20",children:[e.jsx("button",{onClick:()=>xt(t=>!t),className:"p-2 rounded-lg bg-white/80 dark:bg-gray-700/80 border border-gray-200 dark:border-gray-600 shadow hover:shadow-md transition",title:"M…ôtn √∂l√ß√ºs√º",children:e.jsx(u,{name:"type",size:16})}),pt&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"M…ôtn √∂l√ß√ºs√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:X,onChange:t=>je(parseFloat(t.target.value)),className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>je(.95),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>je(1),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A"}),e.jsx("button",{onClick:()=>je(1.2),className:"px-2 py-1 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsxs("div",{ref:$,className:"flex-1 overflow-y-auto space-y-3 pr-1 md:pr-2 custom-scrollbar",style:{maxHeight:"calc(100vh - 240px)"},children:[e.jsx(re,{children:N.map((t,i)=>e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},className:`group relative max-w-[90%] md:max-w-[85%] rounded-xl px-3 md:px-4 py-2 md:py-3 ${t.role==="user"?"ml-auto bg-emerald-50/60 dark:bg-emerald-900/20":"mr-auto bg-gray-100/60 dark:bg-gray-700/50"} shadow-lg hover:shadow-xl dark:shadow-2xl dark:hover:shadow-3xl border border-emerald-100 dark:border-gray-600 backdrop-blur-md transition-all duration-300 hover:-translate-y-0.5`,style:{},children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:t.role==="user"?e.jsx("div",{className:"flex items-center gap-2",children:d?.user?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:_},children:d.user.name}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:_},children:"Siz - Qonaq"})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium text-white",style:{backgroundColor:K},children:Je||"AI Assistant"}),e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",title:"AI Aktiv"})]})}),t.created_at&&e.jsxs("div",{className:"text-xs text-gray-400 flex flex-col items-end",children:[e.jsx("span",{className:"hidden md:block",children:new Date(t.created_at).toLocaleDateString("az-AZ",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("span",{children:new Date(t.created_at).toLocaleTimeString("az-AZ",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"absolute top-1.5 right-1.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>yt(Ue===(t.id||i)?null:t.id||i),className:"p-1.5 rounded-full bg-white/90 dark:bg-gray-800/90 border border-gray-200 dark:border-gray-600 shadow",title:"Mesaj m…ôtni √∂l√ß√ºs√º",children:e.jsx(u,{name:"type",size:12})}),Ue===(t.id||i)&&e.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 shadow-lg p-3 z-10",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bu mesaj √º√ß√ºn √∂l√ß√º"}),e.jsx("input",{type:"range",min:"0.85",max:"1.4",step:"0.05",value:Ie.get(t.id)??X,onChange:l=>{const n=parseFloat(l.target.value);Ne(m=>{const h=new Map(m);return h.set(t.id,n),h})},className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("button",{onClick:()=>Ne(l=>{const n=new Map(l);return n.set(t.id,Math.max(.85,(n.get(t.id)??X)-.05)),n}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A-"}),e.jsx("button",{onClick:()=>Ne(l=>{const n=new Map(l);return n.set(t.id,X),n}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"Sƒ±fƒ±rla"}),e.jsx("button",{onClick:()=>Ne(l=>{const n=new Map(l);return n.set(t.id,Math.min(1.4,(n.get(t.id)??X)+.05)),n}),className:"px-2 py-1 text-[11px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200",children:"A+"})]})]})]}),e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed text-gray-800 dark:text-gray-200",style:{fontSize:`${Ie.get(t.id)??X}rem`},children:t.role==="assistant"?nt.has(t.id)?e.jsx(Bt,{text:t.fullContent,speed:wt,onComplete:()=>{L(l=>{const n=l.map(m=>m.id===t.id?{...m,content:t.fullContent,isTyping:!1}:m);return!d?.user&&j&&setTimeout(()=>{Ve(j,null,n)},100),n}),we(l=>{const n=new Set(l);return n.delete(t.id),n}),Z(!1)}}):e.jsx(Ht,{content:t.content||""}):e.jsx("div",{className:"whitespace-pre-wrap",style:{fontSize:`${Ie.get(t.id)??X}rem`},children:t.content})}),t.role==="assistant"&&!t.isTyping&&e.jsxs("div",{className:"flex items-center justify-start md:justify-between mt-2 flex-wrap gap-1 md:gap-2",children:[(()=>{const l=String(t.id||"");return!(We.has(l)||ee.has(t.id))})()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>tt(String(t.id||""),t.content||t.fullContent,"like"),disabled:ee.has(t.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${ee.get(t.id)==="like"?"text-green-600 bg-green-50 dark:bg-green-900/30":"text-gray-400 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/30"} disabled:opacity-50`,title:"B…ôy…ôn",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"heart",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:ee.get(t.id)==="like"?"B…ôy…ôndiniz":"B…ôy…ôn"})]})}),e.jsx("button",{onClick:()=>tt(String(t.id||""),t.content||t.fullContent,"dislike"),disabled:ee.has(t.id),className:`p-1 md:p-1.5 rounded-lg transition-all group/btn ${ee.get(t.id)==="dislike"?"text-red-600 bg-red-50 dark:bg-red-900/30":"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30"} disabled:opacity-50`,title:"B…ôy…ônm…ô",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"dislike",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:ee.get(t.id)==="dislike"?"B…ôy…ônm…ôdiniz":"B…ôy…ônm…ô"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-75 hover:opacity-100 transition-opacity",children:[t.ragMeta?.dominant_kb_id!=null&&e.jsx("button",{onClick:()=>St(t),className:"px-3 md:px-4 py-1.5 md:py-2 rounded-xl text-xs md:text-sm text-white font-medium transition-all duration-300 shadow-lg hover:shadow-xl flex items-center gap-2 bg-gradient-to-r hover:brightness-110",style:{background:`linear-gradient(135deg, ${_}DD, ${K}DD)`},title:"Daha √ßox m…ôlumat ver",children:"Daha √ßox m…ôlumat ver"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.content||t.fullContent),s.success("M…ôtn kopyalandƒ±!")},className:"p-1 md:p-1.5 text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 rounded-lg transition-all group/btn",title:"M…ôtn kopyala",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"copy",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Kopyala"})]})}),e.jsx("button",{onClick:()=>{s.success("Geribildiri≈üiniz g√∂nd…ôrilir..."),(async()=>{try{const n=t.id,m=n!=null?String(n):void 0,h={message_content:t.content||t.fullContent,session_id:j,timestamp:t.created_at,user_info:d?.user?{name:d.user.name,email:d.user.email}:"Qonaq istifad…ô√ßi"};m!==void 0&&(h.message_id=m);const q=await F.post("/chat/report-feedback",h);setTimeout(()=>{s.success("Geribildiri≈üiniz g√∂nd…ôrildi!")},1e3)}catch(n){console.error("Feedback report error:",n);const m=n.response?.data?.message||n.response?.data?.error||"X…ôta ba≈ü verdi";setTimeout(()=>{s.error("Geribildiri≈ü g√∂nd…ôrilm…ôdi: "+m)},1e3)}})()},className:"p-1 md:p-1.5 text-gray-400 hover:text-orange-500 hover:bg-orange-50 rounded-lg transition-all group/btn",title:"S…ôhv cavab haqqƒ±nda bildi≈ü g√∂nd…ôr",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{name:"warning",size:14}),e.jsx("span",{className:"hidden md:inline text-xs opacity-0 group-hover/btn:opacity-100 transition-opacity whitespace-nowrap",children:"Bildir"})]})})]})]})]},t.id||i))}),Be&&e.jsx(Et,{chatbotName:Je}),Be&&He&&e.jsx("div",{className:"mt-1 text-[12px] italic text-gray-500 dark:text-gray-400",children:He})]}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsxs("div",{className:"relative bg-white/50 dark:bg-gray-800/50 backdrop-blur-lg rounded-2xl border border-white/30 dark:border-gray-700/30 shadow-2xl hover:shadow-3xl transition-all duration-300 p-1",children:[e.jsxs("div",{className:"relative flex items-end gap-2",children:[e.jsx("textarea",{ref:oe,className:`flex-1 bg-transparent border-none outline-none focus:outline-none focus:ring-0 resize-none text-sm md:text-base p-3 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-gray-100 min-h-[50px] max-h-[150px] ${J&&Q?"text-red-600 placeholder-red-400":""} ${R||A?"opacity-50 cursor-not-allowed":""}`,placeholder:ie?`Limit doldu - ${Qe(le)}`:A?"√áatbot yazƒ±r... g√∂zl…ôyin":R?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin...":"Mesajƒ±nƒ±zƒ± yazƒ±n...",value:ae,onChange:t=>{if(!R&&!A){const i=t.target.value;be(te>0?i.slice(0,te):i)}try{const i=oe.current;if(i){i.style.height="auto";const l=(window.innerWidth<768,150);i.style.height=Math.min(i.scrollHeight,l)+"px"}}catch{}},onInput:()=>{try{const t=oe.current;if(t){t.style.height="auto";const i=(window.innerWidth<768,150);t.style.height=Math.min(t.scrollHeight,i)+"px"}}catch{}},onKeyDown:Ct,disabled:R,rows:2}),e.jsxs("div",{className:"flex items-center gap-1 pb-3 pr-1",children:[e.jsx("button",{onClick:()=>st(!ne),className:`p-2 rounded-lg transition-all shadow-sm hover:shadow-md border backdrop-blur-sm ${ne?"bg-emerald-500/90 text-white border-emerald-400/50 shadow-emerald-500/25":"bg-white/70 dark:bg-gray-700/70 text-gray-600 dark:text-gray-300 border-gray-300/50 dark:border-gray-600/50"}`,title:ne?"Enter il…ô g√∂nd…ôr aktiv":"Enter il…ô g√∂nd…ôr deaktiv",children:e.jsx(u,{name:"enter",size:14})}),e.jsx("button",{onClick:()=>r||A?et():Ze(),disabled:J&&Q||R,className:"p-3.5 md:p-4 rounded-2xl text-white font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-all shadow-lg hover:shadow-xl hover:scale-105 bg-gradient-to-r",style:{background:r||A||J&&Q||R?"#ef4444":`linear-gradient(135deg, ${_}DD, ${K}DD)`,boxShadow:`0 4px 20px ${r||A?"#ef444420":`${_}20`}`},title:r||A?"Dayandƒ±r":R?"ƒ∞stifad…ô ≈ü…ôrtl…ôrini q…ôbul edin":"G√∂nd…ôr",children:e.jsx(u,{name:r||A?"stop":R?"shield_check":"send",size:18})})]})]}),e.jsx("div",{className:"absolute -bottom-12 right-2",children:e.jsxs("div",{className:"group relative inline-flex items-center justify-center",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full rounded-xl bg-gradient-to-r opacity-75 animate-ping",style:{backgroundImage:`linear-gradient(135deg, ${_}40, ${K}40)`,animationDuration:"2s"}}),e.jsx("span",{className:"absolute inline-flex h-full w-full rounded-xl bg-gradient-to-r opacity-75 animate-pulse",style:{backgroundImage:`linear-gradient(135deg, ${_}30, ${K}30)`,animationDuration:"1.5s"}}),e.jsx("button",{type:"button",onClick:()=>Xe(!0),className:"relative p-3 rounded-xl text-white font-medium flex items-center justify-center transition-all shadow-lg hover:shadow-xl hover:scale-105 backdrop-blur-sm cursor-pointer",style:{backgroundColor:_,boxShadow:`0 4px 20px ${_}20`},title:"Parametrl…ôr",children:e.jsx(u,{name:"settings",size:16,className:"animate-spin-slow",style:{animationDuration:"8s"}})})]})})]})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs transition-all text-gray-800 ${J&&Q?"text-red-600 font-medium":J&&Ye<50?"text-yellow-600":"dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]"}`,children:"Daxiletm…ô limiti:"}),e.jsx("span",{className:"inline-flex items-center justify-center min-w-[2.5rem] h-6 px-2 rounded-full text-xs font-bold text-white shadow-sm transition-all",style:{backgroundColor:J&&Q?"#ef4444":J&&Ye<50?"#eab308":K},children:te}),e.jsx("span",{className:"text-xs text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"simvol"}),ge>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"|"}),e.jsx("span",{className:"text-xs text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"istifad…ô:"}),e.jsx("span",{className:"inline-flex items-center justify-center min-w-[2.5rem] h-6 px-2 rounded-full text-xs font-bold text-white shadow-sm transition-all",style:{backgroundColor:J&&Q?"#ef4444":_},children:ge})]})]}),J&&Q&&e.jsxs("p",{className:"text-xs text-red-600 font-medium flex items-center gap-1",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-red-100 dark:bg-red-900/30",children:"‚ö†Ô∏è"}),"Limit ke√ßildi!"]})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 px-4 py-2 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg inline-block",children:["‚ö†Ô∏è ",kt]})}),e.jsx("p",{className:"text-xs mt-1 text-center text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:ne?e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"Enter"})," - ",e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"g√∂nd…ôr"}),", ",e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"Shift+Enter"})," - ",e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"yeni s…ôtir"})]}):e.jsxs("span",{children:[e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"Enter"})," - ",e.jsx("strong",{className:"text-gray-800 dark:!text-white dark:drop-shadow-[0_1px_2px_rgba(0,0,0,0.8)]",children:"yeni s…ôtir"})]})})]})})})]}),e.jsx("div",{className:"mt-auto",children:e.jsx(Mt,{footerSettings:b})})]}),e.jsx($t,{}),e.jsx(Lt,{isOpen:gt,onAccept:jt,onReject:Nt,siteName:de}),it&&It.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999]",onClick:()=>ve(!1),children:[e.jsx("div",{className:"absolute inset-0"}),e.jsxs("div",{className:"absolute w-[18rem] md:w-[20rem] p-3 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-2xl text-xs text-gray-700 dark:text-gray-200 limit-popover-animate backdrop-blur-lg",style:{top:Ge.top,left:Ge.left},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"font-semibold mb-1",children:"Limit qaydasƒ±"}),B.limit_type==="monthly"?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"Aylƒ±q limit 30 g√ºnd…ôn bir b…ôrpa olunur. ƒ∞lk mesaj g√∂nd…ôrdiyiniz vaxt ba≈ülanƒüƒ±c n√∂qt…ôsidir."}),e.jsx("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"N√ºmun…ô: ƒ∞lk mesajƒ± bu g√ºn 14:00-da g√∂nd…ôrmisinizs…ô, n√∂vb…ôti b…ôrpa 30 g√ºn sonra eyni tarix v…ô saatda olacaq."}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",B.monthly_reset_time?new Date(B.monthly_reset_time).toLocaleString("az-AZ"):"H…ôl…ô ba≈ülanmayƒ±b"]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"G√ºnl√ºk limit yalnƒ±z 0-a d√º≈üd√ºkd…ô 24 saatlƒ±q geri sayƒ±m ba≈ülayƒ±r."}),e.jsxs("p",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["N√ºmun…ô: D√ºn…ôn 14:00-da istifad…ô etdiniz v…ô h…ôl…ô ",B.daily_remaining??B.remaining," qalƒ±bsa, sabah 14:00-da yenil…ônmir. 0 etdiyiniz andan 24 saat sonra b…ôrpa olacaq."]}),e.jsxs("p",{className:"mt-1",children:["N√∂vb…ôti b…ôrpa: ",B.reset_time?new Date(B.reset_time).toLocaleString("az-AZ"):"Limit bitm…ôyib"]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"font-semibold mb-0.5",children:"‚ÄúSorƒüu‚Äù n…ôdir?"}),e.jsx("p",{children:"H…ôr g√∂nd…ôrdiyiniz mesaj 1 sorƒüudur."})]})]})]}),document.body),e.jsx(At,{isOpen:ut,onConfirm:bt,onCancel:ft,chatTitle:U?.title||U?.session_id?.slice(0,8)||"",siteName:de}),e.jsx(qt,{isOpen:ht,onClose:()=>Xe(!1),isAuthenticated:!!d?.user})]})})}export{Zt as default};
